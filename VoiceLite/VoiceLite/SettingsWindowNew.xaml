<Window x:Class="VoiceLite.SettingsWindowNew"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:controls="clr-namespace:VoiceLite.Controls"
        mc:Ignorable="d"
        Title="VoiceLite Settings" Height="650" Width="850"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResize"
        MinHeight="500" MinWidth="700"
        PreviewKeyDown="Window_PreviewKeyDown">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="#FAFAFA" Padding="20,15">
            <Grid>
                <TextBlock Text="VoiceLite Settings" FontSize="20" FontWeight="SemiBold" Foreground="#333333" HorizontalAlignment="Left"/>
                <TextBlock Name="VersionText" Text="" FontSize="12" Foreground="#95A5A6" HorizontalAlignment="Right" VerticalAlignment="Center"/>
            </Grid>
        </Border>

        <!-- Tabbed Content -->
        <TabControl Grid.Row="1"
                    Name="SettingsTabControl"
                    TabStripPlacement="Top"
                    Margin="0"
                    BorderThickness="0"
                    Background="White">
            <TabControl.Resources>
                <Style TargetType="TabItem" BasedOn="{StaticResource ModernSettingsTabStyle}"/>
            </TabControl.Resources>

            <!-- General Settings Tab -->
            <TabItem Header="General">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                    <StackPanel>
                        <!-- Hotkey Settings -->
                        <GroupBox Header="Hotkey Settings" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                <TextBlock Text="Record Hotkey:" Margin="0,0,0,5"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" MaxWidth="300"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>

                                    <TextBox Name="HotkeyTextBox"
                                             Grid.Column="0"
                                             IsReadOnly="True"
                                             Text="F1"
                                             Padding="5"
                                             Background="#F0F0F0"
                                             PreviewKeyDown="HotkeyTextBox_PreviewKeyDown"
                                             GotFocus="HotkeyTextBox_GotFocus"
                                             LostFocus="HotkeyTextBox_LostFocus"/>

                                    <Button Name="ClearHotkeyButton"
                                            Grid.Column="1"
                                            Content="Clear"
                                            Width="60"
                                            Margin="5,0,0,0"
                                            Click="ClearHotkeyButton_Click"/>
                                </Grid>
                                <TextBlock Name="HotkeyInstructionText"
                                           Text="Click the box and press your desired key combination"
                                           FontSize="11"
                                           Foreground="Gray"
                                           Margin="0,5,0,0"
                                           Visibility="Visible"/>
                            </StackPanel>
                        </GroupBox>

                        <!-- Recording Mode -->
                        <GroupBox Header="Recording Mode" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                <RadioButton Name="PushToTalkRadio"
                                             Content="Push-to-Talk (Hold key to record)"
                                             IsChecked="True"
                                             Margin="0,0,0,5"/>
                                <RadioButton Name="ToggleRadio"
                                             Content="Toggle (Press once to start, again to stop)"
                                             IsEnabled="True"/>
                            </StackPanel>
                        </GroupBox>

                        <!-- Audio Settings -->
                        <GroupBox Header="Audio Settings" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                <TextBlock Text="Microphone:" Margin="0,0,0,5"/>
                                <ComboBox Name="MicrophoneComboBox"
                                          Margin="0,0,0,10"
                                          DisplayMemberPath="Name"
                                          MaxWidth="400"
                                          HorizontalAlignment="Left"/>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                    <Button Name="RefreshMicrophonesButton"
                                            Content="Refresh Microphones"
                                            Width="150"
                                            HorizontalAlignment="Left"
                                            Click="RefreshMicrophonesButton_Click"
                                            Margin="0,0,8,0"/>
                                    <Button Name="TestMicrophoneButton"
                                            Content="Test Microphone"
                                            Width="130"
                                            HorizontalAlignment="Left"
                                            Click="TestMicrophoneButton_Click"
                                            ToolTip="Click to start/stop recording test"/>
                                </StackPanel>

                                <CheckBox Name="PlaySoundFeedbackCheckBox"
                                          Content="Play sound feedback (beep on record start/stop)"
                                          Margin="0,10,0,5"/>

                                <CheckBox Name="AutoPasteCheckBox"
                                          Content="Auto-paste transcribed text (Ctrl+V)"
                                          IsChecked="True"
                                          Margin="0,0,0,0"
                                          ToolTip="When enabled, transcribed text will automatically paste into the active application. When disabled, text is only copied to clipboard."/>
                            </StackPanel>
                        </GroupBox>

                        <!-- Other Settings -->
                        <GroupBox Header="System Settings" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                <CheckBox Name="StartWithWindowsCheckBox"
                                          Content="Start with Windows"
                                          Margin="0,0,0,5"
                                          IsEnabled="False"/>
                                <CheckBox Name="MinimizeToTrayCheckBox"
                                          Content="Minimize to system tray on close"
                                          IsChecked="True"
                                          Margin="0,0,0,5"/>
                                <CheckBox Name="ShowTrayIconCheckBox"
                                          Content="Show system tray icon"
                                          IsChecked="True"
                                          IsEnabled="False"
                                          Margin="0,0,0,5"/>
                            </StackPanel>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Whisper Model Tab -->
            <TabItem Header="AI Model" Name="ModelTab">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                    <StackPanel>
                        <controls:SimpleModelSelector x:Name="SimpleModelSelector"
                                                      ModelSelected="SimpleModelSelector_ModelSelected"/>

                        <Button Name="DownloadModelsButton"
                                Content="Download Elite Model (1.5GB)"
                                Height="35"
                                Margin="0,15,0,0"
                                Click="DownloadModelsButton_Click"
                                Visibility="Visible"/>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Dictionary Tab -->
            <TabItem Header="Dictionary" Name="DictionaryTab">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                    <StackPanel>
                        <!-- Header Info -->
                        <TextBlock Text="VoiceShortcuts"
                                   FontSize="18"
                                   FontWeight="SemiBold"
                                   Foreground="#333333"
                                   Margin="0,0,0,8"/>
                        <TextBlock Text="Create custom word replacements to improve transcription accuracy. Perfect for abbreviations, industry terms, and personal names."
                                   TextWrapping="Wrap"
                                   Foreground="#666666"
                                   FontSize="12"
                                   Margin="0,0,0,20"/>

                        <!-- Enable/Disable -->
                        <Border Background="#F8F9FA"
                                Padding="15"
                                CornerRadius="6"
                                Margin="0,0,0,20">
                            <StackPanel>
                                <CheckBox Name="EnableCustomDictionaryCheckBox"
                                          Content="Enable VoiceShortcuts"
                                          IsChecked="True"
                                          FontSize="13"
                                          FontWeight="SemiBold"
                                          Margin="0,0,0,8"/>
                                <TextBlock Name="DictionaryCountText"
                                           Text="0 entries loaded"
                                           FontSize="12"
                                           Foreground="#666666"
                                           Margin="20,0,0,0"/>
                            </StackPanel>
                        </Border>

                        <!-- Quick Actions -->
                        <GroupBox Header="Quick Actions" Margin="0,0,0,20">
                            <StackPanel Margin="10">
                                <Button Name="ManageDictionaryButton"
                                        Content="📝 Manage VoiceShortcuts"
                                        Height="40"
                                        FontSize="13"
                                        HorizontalAlignment="Stretch"
                                        Click="ManageDictionaryButton_Click"
                                        ToolTip="Add, edit, or remove voice shortcuts and custom word replacements"
                                        Margin="0,0,0,10"/>

                                <TextBlock Text="Load Pre-built Templates:"
                                           FontWeight="SemiBold"
                                           FontSize="12"
                                           Margin="0,10,0,8"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <Button Name="LoadMedicalTemplateButton"
                                            Grid.Column="0"
                                            Content="🏥 Medical (33 terms)"
                                            Height="35"
                                            FontSize="11"
                                            Margin="0,0,5,0"
                                            Click="LoadMedicalTemplate_Click"
                                            ToolTip="Load medical abbreviations: BP, CBC, PRN, etc."/>
                                    <Button Name="LoadLegalTemplateButton"
                                            Grid.Column="1"
                                            Content="⚖️ Legal (20 terms)"
                                            Height="35"
                                            FontSize="11"
                                            Margin="5,0,5,0"
                                            Click="LoadLegalTemplate_Click"
                                            ToolTip="Load legal terms: SCOTUS, NDA, LLC, etc."/>
                                    <Button Name="LoadTechTemplateButton"
                                            Grid.Column="2"
                                            Content="💻 Tech (31 terms)"
                                            Height="35"
                                            FontSize="11"
                                            Margin="5,0,0,0"
                                            Click="LoadTechTemplate_Click"
                                            ToolTip="Load tech abbreviations: AWS, k8s, API, etc."/>
                                </Grid>
                            </StackPanel>
                        </GroupBox>

                        <!-- Examples -->
                        <GroupBox Header="Examples" Margin="0,0,0,0">
                            <StackPanel Margin="10">
                                <TextBlock Text="Medical:" FontWeight="SemiBold" FontSize="12" Margin="0,0,0,5"/>
                                <TextBlock Text="• Say 'BP is elevated' → 'blood pressure is elevated'"
                                           FontSize="11" Foreground="#666666" Margin="10,0,0,3"/>
                                <TextBlock Text="• Say 'CBC was normal' → 'complete blood count was normal'"
                                           FontSize="11" Foreground="#666666" Margin="10,0,0,10"/>

                                <TextBlock Text="Tech:" FontWeight="SemiBold" FontSize="12" Margin="0,0,0,5"/>
                                <TextBlock Text="• Say 'Deploy to k8s' → 'Deploy to Kubernetes'"
                                           FontSize="11" Foreground="#666666" Margin="10,0,0,3"/>
                                <TextBlock Text="• Say 'Using AWS' → 'Using Amazon Web Services'"
                                           FontSize="11" Foreground="#666666" Margin="10,0,0,10"/>

                                <TextBlock Text="Custom:" FontWeight="SemiBold" FontSize="12" Margin="0,0,0,5"/>
                                <TextBlock Text="• Pattern: 'VL' → Replacement: 'VoiceLite'"
                                           FontSize="11" Foreground="#666666" Margin="10,0,0,0"/>
                            </StackPanel>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Text Formatting Tab -->
            <TabItem Header="Text Formatting" Name="TextFormattingTab">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                    <StackPanel>
                        <!-- Quick Presets -->
                        <Border Background="#F8F9FA" Padding="15" CornerRadius="6" Margin="0,0,0,20">
                            <StackPanel>
                                <TextBlock Text="Quick Presets" FontSize="14" FontWeight="SemiBold" Margin="0,0,0,10"/>
                                <StackPanel Orientation="Horizontal">
                                    <Button Name="ProfessionalPresetButton"
                                            Content="📝 Professional"
                                            Width="120"
                                            Height="35"
                                            Margin="0,0,5,0"
                                            Click="ProfessionalPreset_Click"
                                            ToolTip="Remove all fillers, expand contractions, fix grammar"/>
                                    <Button Name="CodePresetButton"
                                            Content="💻 Code"
                                            Width="120"
                                            Height="35"
                                            Margin="5,0,5,0"
                                            Click="CodePreset_Click"
                                            ToolTip="Preserve casing, no punctuation, no filler removal"/>
                                    <Button Name="CasualPresetButton"
                                            Content="💬 Casual"
                                            Width="120"
                                            Height="35"
                                            Margin="5,0,0,0"
                                            Click="CasualPreset_Click"
                                            ToolTip="Light filler removal, keep contractions"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>

                        <!-- Capitalization -->
                        <GroupBox Header="Capitalization" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                <CheckBox Name="EnableCapitalizationCheckBox"
                                          Content="Enable sentence capitalization"
                                          IsChecked="True"
                                          Margin="0,0,0,10"
                                          Checked="UpdatePreview"
                                          Unchecked="UpdatePreview"/>

                                <StackPanel Margin="20,0,0,0">
                                    <CheckBox Name="CapFirstLetterCheckBox"
                                              Content="Capitalize first letter"
                                              IsChecked="True"
                                              Margin="0,0,0,5"
                                              Checked="UpdatePreview"
                                              Unchecked="UpdatePreview"
                                              IsEnabled="{Binding IsChecked, ElementName=EnableCapitalizationCheckBox}"/>
                                    <CheckBox Name="CapAfterPeriodCheckBox"
                                              Content="Capitalize after periods"
                                              IsChecked="True"
                                              Margin="0,0,0,5"
                                              Checked="UpdatePreview"
                                              Unchecked="UpdatePreview"
                                              IsEnabled="{Binding IsChecked, ElementName=EnableCapitalizationCheckBox}"/>
                                    <CheckBox Name="CapAfterQuestionCheckBox"
                                              Content="Capitalize after ?/!"
                                              IsChecked="True"
                                              Margin="0,0,0,10"
                                              Checked="UpdatePreview"
                                              Unchecked="UpdatePreview"
                                              IsEnabled="{Binding IsChecked, ElementName=EnableCapitalizationCheckBox}"/>
                                </StackPanel>
                            </StackPanel>
                        </GroupBox>

                        <!-- Ending Punctuation -->
                        <GroupBox Header="Ending Punctuation" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                <CheckBox Name="EnableEndingPunctuationCheckBox"
                                          Content="Auto-add ending punctuation"
                                          IsChecked="True"
                                          Margin="0,0,0,10"
                                          Checked="UpdatePreview"
                                          Unchecked="UpdatePreview"/>

                                <StackPanel Margin="20,0,0,0" IsEnabled="{Binding IsChecked, ElementName=EnableEndingPunctuationCheckBox}">
                                    <TextBlock Text="Default punctuation:" Margin="0,0,0,5"/>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                        <RadioButton Name="PeriodRadio"
                                                     Content="Period (.)"
                                                     GroupName="DefaultPunctuation"
                                                     IsChecked="True"
                                                     Margin="0,0,15,0"
                                                     Checked="UpdatePreview"/>
                                        <RadioButton Name="QuestionRadio"
                                                     Content="Question (?)"
                                                     GroupName="DefaultPunctuation"
                                                     Margin="0,0,15,0"
                                                     Checked="UpdatePreview"/>
                                        <RadioButton Name="ExclamationRadio"
                                                     Content="Exclamation (!)"
                                                     GroupName="DefaultPunctuation"
                                                     Checked="UpdatePreview"/>
                                    </StackPanel>

                                    <CheckBox Name="SmartPunctuationCheckBox"
                                              Content="Use smart detection (questions end with ?)"
                                              Margin="0,0,0,5"
                                              Checked="UpdatePreview"
                                              Unchecked="UpdatePreview"/>
                                </StackPanel>
                            </StackPanel>
                        </GroupBox>

                        <!-- Filler Word Removal -->
                        <GroupBox Header="Filler Word Removal" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                <TextBlock Text="Remove common filler words from transcriptions:"
                                           TextWrapping="Wrap"
                                           FontSize="12"
                                           Foreground="#666666"
                                           Margin="0,0,0,10"/>

                                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                    <TextBlock Text="Intensity:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                    <Slider Name="FillerIntensitySlider"
                                            Minimum="0"
                                            Maximum="4"
                                            TickFrequency="1"
                                            IsSnapToTickEnabled="True"
                                            Value="0"
                                            Width="200"
                                            ValueChanged="FillerIntensity_Changed"/>
                                    <TextBlock Name="FillerIntensityLabel"
                                               Text="None"
                                               VerticalAlignment="Center"
                                               FontWeight="SemiBold"
                                               Margin="10,0,0,0"/>
                                </StackPanel>

                                <Border Background="#F5F5F5" Padding="10" CornerRadius="4" Margin="0,0,0,10">
                                    <StackPanel>
                                        <TextBlock Text="Built-in Lists:" FontWeight="SemiBold" FontSize="12" Margin="0,0,0,5"/>
                                        <CheckBox Name="HesitationsCheckBox"
                                                  Content="Hesitations (um, uh, er, ah, hmm)"
                                                  Margin="0,0,0,3"
                                                  Checked="UpdatePreview"
                                                  Unchecked="UpdatePreview"/>
                                        <CheckBox Name="VerbalTicsCheckBox"
                                                  Content="Verbal tics (like, you know, I mean, I guess)"
                                                  Margin="0,0,0,3"
                                                  Checked="UpdatePreview"
                                                  Unchecked="UpdatePreview"/>
                                        <CheckBox Name="QualifiersCheckBox"
                                                  Content="Qualifiers (sort of, kind of, pretty much)"
                                                  Margin="0,0,0,3"
                                                  Checked="UpdatePreview"
                                                  Unchecked="UpdatePreview"/>
                                        <CheckBox Name="IntensifiersCheckBox"
                                                  Content="Intensifiers (literally, actually, honestly)"
                                                  Margin="0,0,0,3"
                                                  Checked="UpdatePreview"
                                                  Unchecked="UpdatePreview"/>
                                        <CheckBox Name="TransitionsCheckBox"
                                                  Content="Transitions (so yeah, anyway, well)"
                                                  Margin="0,0,0,3"
                                                  Checked="UpdatePreview"
                                                  Unchecked="UpdatePreview"/>
                                    </StackPanel>
                                </Border>

                                <TextBlock Text="Custom Filler Words:" FontWeight="SemiBold" FontSize="12" Margin="0,10,0,5"/>
                                <Button Name="ManageCustomFillerWordsButton"
                                        Content="Manage Custom Filler Words..."
                                        Width="200"
                                        HorizontalAlignment="Left"
                                        Click="ManageCustomFillerWords_Click"/>
                            </StackPanel>
                        </GroupBox>

                        <!-- Contractions -->
                        <GroupBox Header="Contractions" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                <RadioButton Name="LeaveAsIsRadio"
                                             Content="Leave as-is (no changes)"
                                             GroupName="Contractions"
                                             IsChecked="True"
                                             Margin="0,0,0,5"
                                             Checked="UpdatePreview"/>
                                <RadioButton Name="ExpandRadio"
                                             Content="Expand (don't → do not)"
                                             GroupName="Contractions"
                                             Margin="0,0,0,5"
                                             Checked="UpdatePreview"/>
                                <RadioButton Name="ContractRadio"
                                             Content="Contract (do not → don't)"
                                             GroupName="Contractions"
                                             Checked="UpdatePreview"/>
                            </StackPanel>
                        </GroupBox>

                        <!-- Grammar Fixes -->
                        <GroupBox Header="Grammar &amp; Corrections" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                <CheckBox Name="FixHomophonesCheckBox"
                                          Content="Fix common homophones (their/there/they're, your/you're, its/it's)"
                                          Margin="0,0,0,5"
                                          Checked="UpdatePreview"
                                          Unchecked="UpdatePreview"/>
                                <CheckBox Name="FixDoubleNegativesCheckBox"
                                          Content="Fix double negatives (don't have no → don't have any)"
                                          Margin="0,0,0,5"
                                          Checked="UpdatePreview"
                                          Unchecked="UpdatePreview"/>
                                <CheckBox Name="FixSubjectVerbCheckBox"
                                          Content="Fix subject-verb agreement (I is → I am, they is → they are)"
                                          Checked="UpdatePreview"
                                          Unchecked="UpdatePreview"/>
                            </StackPanel>
                        </GroupBox>

                        <!-- Preview -->
                        <GroupBox Header="Preview" Margin="0,0,0,0">
                            <StackPanel Margin="10">
                                <TextBlock Text="Sample input (edit to test):" Margin="0,0,0,5"/>
                                <TextBox Name="PreviewInputTextBox"
                                         Text="um, this is like a test, you know"
                                         TextWrapping="Wrap"
                                         Height="60"
                                         Padding="5"
                                         TextChanged="UpdatePreview"/>

                                <Grid Margin="0,10,0,0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <StackPanel Grid.Column="0" Margin="0,0,5,0">
                                        <TextBlock Text="Before:" FontWeight="SemiBold" FontSize="12" Margin="0,0,0,5"/>
                                        <Border Background="#FFEBEE" Padding="10" CornerRadius="4" MinHeight="60">
                                            <TextBlock Name="PreviewBeforeText"
                                                       TextWrapping="Wrap"
                                                       FontFamily="Consolas"
                                                       FontSize="11"/>
                                        </Border>
                                    </StackPanel>

                                    <StackPanel Grid.Column="1" Margin="5,0,0,0">
                                        <TextBlock Text="After:" FontWeight="SemiBold" FontSize="12" Margin="0,0,0,5"/>
                                        <Border Background="#E8F5E9" BorderBrush="#4CAF50" BorderThickness="1" Padding="10" CornerRadius="4" MinHeight="60">
                                            <TextBlock Name="PreviewAfterText"
                                                       TextWrapping="Wrap"
                                                       FontFamily="Consolas"
                                                       FontSize="11"
                                                       Foreground="#2E7D32"/>
                                        </Border>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Advanced Tab -->
            <TabItem Header="Advanced">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                    <StackPanel>
                        <!-- Whisper Advanced Parameters -->
                        <GroupBox Header="Whisper Parameters" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="150"/>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <TextBlock Grid.Row="0" Grid.Column="0"
                                               Text="Beam size:"
                                               VerticalAlignment="Center"
                                               Margin="0,0,0,10"/>
                                    <TextBox Grid.Row="0" Grid.Column="1"
                                             Name="BeamSizeTextBox"
                                             Width="60"
                                             HorizontalAlignment="Left"
                                             Margin="0,0,0,10"/>
                                    <TextBlock Grid.Row="0" Grid.Column="2"
                                               Text="(Higher = more accurate but slower)"
                                               FontSize="11"
                                               Foreground="Gray"
                                               VerticalAlignment="Center"
                                               Margin="10,0,0,10"/>

                                    <TextBlock Grid.Row="1" Grid.Column="0"
                                               Text="Best of:"
                                               VerticalAlignment="Center"
                                               Margin="0,0,0,10"/>
                                    <TextBox Grid.Row="1" Grid.Column="1"
                                             Name="BestOfTextBox"
                                             Width="60"
                                             HorizontalAlignment="Left"
                                             Margin="0,0,0,10"/>
                                    <TextBlock Grid.Row="1" Grid.Column="2"
                                               Text="(Number of candidates to consider)"
                                               FontSize="11"
                                               Foreground="Gray"
                                               VerticalAlignment="Center"
                                               Margin="10,0,0,10"/>

                                    <TextBlock Grid.Row="2" Grid.Column="0"
                                               Text="Timeout multiplier:"
                                               VerticalAlignment="Center"/>
                                    <TextBox Grid.Row="2" Grid.Column="1"
                                             Name="TimeoutMultiplierTextBox"
                                             Width="60"
                                             HorizontalAlignment="Left"/>
                                    <TextBlock Grid.Row="2" Grid.Column="2"
                                               Text="(Seconds per audio second)"
                                               FontSize="11"
                                               Foreground="Gray"
                                               VerticalAlignment="Center"
                                               Margin="10,0,0,0"/>
                                </Grid>
                            </StackPanel>
                        </GroupBox>

                        <!-- Audio Preprocessing -->
                        <GroupBox Header="Audio Preprocessing" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                <CheckBox Name="NoiseSuppressionCheckBox"
                                          Content="Enable noise suppression"
                                          Margin="0,0,0,5"/>
                                <CheckBox Name="AutoGainCheckBox"
                                          Content="Enable automatic gain control"
                                          Margin="0,0,0,10"/>

                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="150"/>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <TextBlock Grid.Row="0" Grid.Column="0"
                                               Text="Target RMS level:"
                                               VerticalAlignment="Center"
                                               Margin="0,0,0,10"/>
                                    <TextBox Grid.Row="0" Grid.Column="1"
                                             Name="TargetRmsTextBox"
                                             Width="60"
                                             HorizontalAlignment="Left"
                                             Margin="0,0,0,10"/>

                                    <TextBlock Grid.Row="1" Grid.Column="0"
                                               Text="Noise gate threshold:"
                                               VerticalAlignment="Center"/>
                                    <TextBox Grid.Row="1" Grid.Column="1"
                                             Name="NoiseThresholdTextBox"
                                             Width="60"
                                             HorizontalAlignment="Left"/>
                                </Grid>
                            </StackPanel>
                        </GroupBox>

                        <!-- Performance Settings -->
                        <GroupBox Header="Performance" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                <CheckBox Name="UseWhisperServerCheckBox"
                                          Content="Enable Whisper Server Mode (Experimental - 5x faster)"
                                          Margin="0,0,0,5"/>
                                <TextBlock Text="Uses persistent server.exe to keep model in memory. Falls back to process mode if server fails."
                                           FontSize="11"
                                           Foreground="Gray"
                                           TextWrapping="Wrap"
                                           Margin="0,0,0,0"/>
                            </StackPanel>
                        </GroupBox>

                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Privacy Tab -->
            <TabItem Header="Privacy">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                    <StackPanel>
                        <!-- Analytics Settings -->
                        <GroupBox Header="Anonymous Analytics" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                <CheckBox Name="EnableAnalyticsCheckBox"
                                          Content="Send anonymous usage analytics"
                                          FontSize="13"
                                          Margin="0,0,0,10"
                                          Checked="EnableAnalyticsCheckBox_Changed"
                                          Unchecked="EnableAnalyticsCheckBox_Changed"/>

                                <TextBlock TextWrapping="Wrap"
                                           FontSize="12"
                                           Foreground="#666666"
                                           Margin="0,0,0,10">
                                    Help us improve VoiceLite by sending anonymous usage data. We track app version, model usage, and transcription counts.
                                </TextBlock>

                                <TextBlock TextWrapping="Wrap"
                                           FontSize="12"
                                           FontWeight="SemiBold"
                                           Foreground="#333333"
                                           Margin="0,10,0,5">
                                    What we track:
                                </TextBlock>
                                <TextBlock TextWrapping="Wrap"
                                           FontSize="11"
                                           Foreground="#666666"
                                           Margin="15,0,0,3">
                                    • App version and operating system
                                </TextBlock>
                                <TextBlock TextWrapping="Wrap"
                                           FontSize="11"
                                           Foreground="#666666"
                                           Margin="15,0,0,3">
                                    • Model used (Lite, Pro, Elite, Ultra)
                                </TextBlock>
                                <TextBlock TextWrapping="Wrap"
                                           FontSize="11"
                                           Foreground="#666666"
                                           Margin="15,0,0,3">
                                    • Daily transcription count (aggregated, no content)
                                </TextBlock>
                                <TextBlock TextWrapping="Wrap"
                                           FontSize="11"
                                           Foreground="#666666"
                                           Margin="15,0,0,15">
                                    • Anonymous user ID (SHA256 hash, irreversible)
                                </TextBlock>

                                <TextBlock TextWrapping="Wrap"
                                           FontSize="12"
                                           FontWeight="SemiBold"
                                           Foreground="#333333"
                                           Margin="0,0,0,5">
                                    What we DON'T track:
                                </TextBlock>
                                <TextBlock TextWrapping="Wrap"
                                           FontSize="11"
                                           Foreground="#666666"
                                           Margin="15,0,0,3">
                                    • Voice recordings or audio data
                                </TextBlock>
                                <TextBlock TextWrapping="Wrap"
                                           FontSize="11"
                                           Foreground="#666666"
                                           Margin="15,0,0,3">
                                    • Transcription text or content
                                </TextBlock>
                                <TextBlock TextWrapping="Wrap"
                                           FontSize="11"
                                           Foreground="#666666"
                                           Margin="15,0,0,3">
                                    • Personal information (name, email)
                                </TextBlock>
                                <TextBlock TextWrapping="Wrap"
                                           FontSize="11"
                                           Foreground="#666666"
                                           Margin="15,0,0,0">
                                    • Keystrokes or screen content
                                </TextBlock>

                                <Border Background="#E3F2FD"
                                        BorderBrush="#2196F3"
                                        BorderThickness="1"
                                        CornerRadius="4"
                                        Padding="10"
                                        Margin="0,15,0,0">
                                    <TextBlock TextWrapping="Wrap"
                                               FontSize="11"
                                               Foreground="#1976D2">
                                        <Run Text="🔒 Privacy First:" FontWeight="Bold"/>
                                        <Run Text="Your voice data is always processed locally and never leaves your computer. Analytics are completely optional and anonymous."/>
                                    </TextBlock>
                                </Border>
                            </StackPanel>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
        </TabControl>

        <!-- Footer with Buttons -->
        <Border Grid.Row="2"
                Background="#F5F5F5"
                BorderBrush="#E0E0E0"
                BorderThickness="0,1,0,0">
            <Grid Margin="20,10">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Status Text and Keyboard Shortcuts Hint -->
                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Name="StatusText"
                               Text=""
                               FontSize="12"
                               Foreground="#606060"
                               VerticalAlignment="Center"
                               Margin="0,0,15,0"/>
                    <TextBlock Text="💡 Tip: Ctrl+S to save, Esc to cancel"
                               FontSize="11"
                               Foreground="#95A5A6"
                               VerticalAlignment="Center"/>
                </StackPanel>

                <!-- Action Buttons -->
                <StackPanel Grid.Column="1"
                            Orientation="Horizontal"
                            HorizontalAlignment="Right">
                    <Button Name="ApplyButton"
                            Content="Apply"
                            Width="80"
                            Margin="0,0,10,0"
                            Click="ApplyButton_Click"/>
                    <Button Name="SaveButton"
                            Content="Save"
                            Width="80"
                            Margin="0,0,10,0"
                            Click="SaveButton_Click"
                            IsDefault="True"/>
                    <Button Name="CancelButton"
                            Content="Cancel"
                            Width="80"
                            Click="CancelButton_Click"
                            IsCancel="True"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>
