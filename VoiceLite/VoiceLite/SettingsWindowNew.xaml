<Window x:Class="VoiceLite.SettingsWindowNew"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:controls="clr-namespace:VoiceLite.Controls"
        mc:Ignorable="d"
        Title="VoiceLite Settings" Height="650" Width="850"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResize"
        MinHeight="500" MinWidth="700"
        PreviewKeyDown="Window_PreviewKeyDown">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="#FAFAFA" Padding="20,15">
            <Grid>
                <TextBlock Text="VoiceLite Settings" FontSize="20" FontWeight="SemiBold" Foreground="#333333" HorizontalAlignment="Left"/>
                <TextBlock Name="VersionText" Text="" FontSize="12" Foreground="#95A5A6" HorizontalAlignment="Right" VerticalAlignment="Center"/>
            </Grid>
        </Border>

        <!-- Tabbed Content -->
        <TabControl Grid.Row="1"
                    Name="SettingsTabControl"
                    TabStripPlacement="Top"
                    Margin="0"
                    BorderThickness="0"
                    Background="White">
            <TabControl.Resources>
                <Style TargetType="TabItem">
                    <Setter Property="Padding" Value="15,8"/>
                    <Setter Property="FontSize" Value="13"/>
                    <Setter Property="Cursor" Value="Hand"/>
                </Style>
            </TabControl.Resources>

            <!-- General Settings Tab -->
            <TabItem Header="General">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                    <StackPanel>
                        <!-- Hotkey Settings -->
                        <Border Style="{StaticResource SettingsCardStyle}">
                            <StackPanel>
                                <!-- Section Header -->
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,14">
                                    <TextBlock Text="🔑" Style="{StaticResource SettingsIconStyle}"/>
                                    <StackPanel>
                                        <TextBlock Text="Hotkey Settings" Style="{StaticResource SettingsSectionHeaderStyle}"/>
                                        <TextBlock Text="Configure your global recording shortcut" Style="{StaticResource SettingsSectionDescStyle}"/>
                                    </StackPanel>
                                </StackPanel>

                                <!-- Hotkey Input -->
                                <TextBlock Text="Record Hotkey:" Margin="0,0,0,6" FontWeight="Medium" FontSize="13"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" MaxWidth="300"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>

                                    <TextBox Name="HotkeyTextBox"
                                             Grid.Column="0"
                                             IsReadOnly="True"
                                             Text="F1"
                                             Padding="10,8"
                                             Background="#F8F9FA"
                                             FontSize="13"
                                             PreviewKeyDown="HotkeyTextBox_PreviewKeyDown"
                                             GotFocus="HotkeyTextBox_GotFocus"
                                             LostFocus="HotkeyTextBox_LostFocus"/>

                                    <Button Name="ClearHotkeyButton"
                                            Grid.Column="1"
                                            Content="Clear"
                                            Width="70"
                                            Height="34"
                                            Margin="8,0,0,0"
                                            Click="ClearHotkeyButton_Click"/>
                                </Grid>
                                <TextBlock Name="HotkeyInstructionText"
                                           Text="💡 Click the box above and press your desired key combination (e.g., Left Alt, F1, Ctrl+Space)"
                                           Style="{StaticResource SettingsHelperTextStyle}"
                                           Visibility="Visible"/>
                            </StackPanel>
                        </Border>

                        <!-- Recording Mode -->
                        <Border Style="{StaticResource SettingsCardStyle}">
                            <StackPanel>
                                <!-- Section Header -->
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,14">
                                    <TextBlock Text="⏺️" Style="{StaticResource SettingsIconStyle}"/>
                                    <StackPanel>
                                        <TextBlock Text="Recording Mode" Style="{StaticResource SettingsSectionHeaderStyle}"/>
                                        <TextBlock Text="Choose how you want to trigger recording" Style="{StaticResource SettingsSectionDescStyle}"/>
                                    </StackPanel>
                                </StackPanel>

                                <!-- Mode Options -->
                                <RadioButton Name="PushToTalkRadio"
                                             IsChecked="True"
                                             Margin="0,0,0,10">
                                    <StackPanel>
                                        <TextBlock Text="Push-to-Talk" FontWeight="SemiBold" FontSize="13"/>
                                        <TextBlock Text="Hold your hotkey while speaking, release to transcribe"
                                                   Style="{StaticResource SettingsHelperTextStyle}"
                                                   Margin="0,3,0,0"/>
                                    </StackPanel>
                                </RadioButton>
                                <RadioButton Name="ToggleRadio" IsEnabled="True">
                                    <StackPanel>
                                        <TextBlock Text="Toggle Mode" FontWeight="SemiBold" FontSize="13"/>
                                        <TextBlock Text="Press once to start recording, press again to stop and transcribe"
                                                   Style="{StaticResource SettingsHelperTextStyle}"
                                                   Margin="0,3,0,0"/>
                                    </StackPanel>
                                </RadioButton>
                            </StackPanel>
                        </Border>

                        <!-- Audio Settings -->
                        <Border Style="{StaticResource SettingsCardStyle}">
                            <StackPanel>
                                <!-- Section Header -->
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,14">
                                    <TextBlock Text="🎙️" Style="{StaticResource SettingsIconStyle}"/>
                                    <StackPanel>
                                        <TextBlock Text="Audio Settings" Style="{StaticResource SettingsSectionHeaderStyle}"/>
                                        <TextBlock Text="Configure your microphone and audio feedback" Style="{StaticResource SettingsSectionDescStyle}"/>
                                    </StackPanel>
                                </StackPanel>

                                <!-- Microphone Selection -->
                                <TextBlock Text="Microphone:" Margin="0,0,0,6" FontWeight="Medium" FontSize="13"/>
                                <ComboBox Name="MicrophoneComboBox"
                                          Margin="0,0,0,10"
                                          DisplayMemberPath="Name"
                                          MaxWidth="400"
                                          HorizontalAlignment="Left"
                                          Padding="10,8"
                                          FontSize="13"/>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,14">
                                    <Button Name="RefreshMicrophonesButton"
                                            Content="🔄 Refresh"
                                            Width="120"
                                            HorizontalAlignment="Left"
                                            Click="RefreshMicrophonesButton_Click"
                                            Margin="0,0,8,0"
                                            ToolTip="Rescan for connected microphones"/>
                                    <Button Name="TestMicrophoneButton"
                                            Content="🎤 Test"
                                            Width="120"
                                            HorizontalAlignment="Left"
                                            Click="TestMicrophoneButton_Click"
                                            ToolTip="Click to start/stop a test recording"/>
                                </StackPanel>

                                <!-- Feedback Options -->
                                <CheckBox Name="PlaySoundFeedbackCheckBox"
                                          Margin="0,0,0,10">
                                    <StackPanel>
                                        <TextBlock Text="Play sound feedback" FontWeight="SemiBold" FontSize="13"/>
                                        <TextBlock Text="Plays a subtle click sound when recording starts and stops"
                                                   Style="{StaticResource SettingsHelperTextStyle}"
                                                   Margin="0,3,0,0"/>
                                    </StackPanel>
                                </CheckBox>

                                <CheckBox Name="AutoPasteCheckBox"
                                          IsChecked="True">
                                    <StackPanel>
                                        <TextBlock Text="Auto-paste transcribed text" FontWeight="SemiBold" FontSize="13"/>
                                        <TextBlock Text="Automatically pastes text into active application. When disabled, text is only copied to clipboard (manual Ctrl+V required)"
                                                   Style="{StaticResource SettingsHelperTextStyle}"
                                                   Margin="0,3,0,0"/>
                                    </StackPanel>
                                </CheckBox>
                            </StackPanel>
                        </Border>

                        <!-- System Settings -->
                        <Border Style="{StaticResource SettingsCardStyle}">
                            <StackPanel>
                                <!-- Section Header -->
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,14">
                                    <TextBlock Text="⚙️" Style="{StaticResource SettingsIconStyle}"/>
                                    <StackPanel>
                                        <TextBlock Text="System Settings" Style="{StaticResource SettingsSectionHeaderStyle}"/>
                                        <TextBlock Text="Configure startup and system tray behavior" Style="{StaticResource SettingsSectionDescStyle}"/>
                                    </StackPanel>
                                </StackPanel>

                                <!-- System Options -->
                                <CheckBox Name="StartWithWindowsCheckBox"
                                          Margin="0,0,0,10"
                                          IsEnabled="False">
                                    <StackPanel>
                                        <TextBlock Text="Start with Windows" FontWeight="SemiBold" FontSize="13"/>
                                        <TextBlock Text="Automatically launch VoiceLite when Windows starts (coming soon)"
                                                   Style="{StaticResource SettingsHelperTextStyle}"
                                                   Margin="0,3,0,0"/>
                                    </StackPanel>
                                </CheckBox>
                                <CheckBox Name="MinimizeToTrayCheckBox"
                                          IsChecked="True"
                                          Margin="0,0,0,10">
                                    <StackPanel>
                                        <TextBlock Text="Minimize to system tray on close" FontWeight="SemiBold" FontSize="13"/>
                                        <TextBlock Text="Clicking X will minimize to tray instead of fully closing the app"
                                                   Style="{StaticResource SettingsHelperTextStyle}"
                                                   Margin="0,3,0,0"/>
                                    </StackPanel>
                                </CheckBox>
                                <CheckBox Name="ShowTrayIconCheckBox"
                                          IsChecked="True"
                                          IsEnabled="False">
                                    <StackPanel>
                                        <TextBlock Text="Show system tray icon" FontWeight="SemiBold" FontSize="13"/>
                                        <TextBlock Text="Display VoiceLite icon in system tray (always enabled)"
                                                   Style="{StaticResource SettingsHelperTextStyle}"
                                                   Margin="0,3,0,0"/>
                                    </StackPanel>
                                </CheckBox>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Whisper Model Tab -->
            <TabItem Header="AI Model" Name="ModelTab">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                    <StackPanel>
                        <controls:SimpleModelSelector x:Name="SimpleModelSelector"
                                                      ModelSelected="SimpleModelSelector_ModelSelected"/>

                        <Button Name="DownloadModelsButton"
                                Content="Download Elite Model (1.5GB)"
                                Height="35"
                                Margin="0,15,0,0"
                                Click="DownloadModelsButton_Click"
                                Visibility="Visible"/>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Dictionary Tab -->
            <TabItem Header="Dictionary" Name="DictionaryTab">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                    <StackPanel>
                        <!-- Header Info -->
                        <TextBlock Text="VoiceShortcuts"
                                   FontSize="18"
                                   FontWeight="SemiBold"
                                   Foreground="#333333"
                                   Margin="0,0,0,8"/>
                        <TextBlock Text="Create custom word replacements to improve transcription accuracy. Perfect for abbreviations, industry terms, and personal names."
                                   TextWrapping="Wrap"
                                   Foreground="#666666"
                                   FontSize="12"
                                   Margin="0,0,0,20"/>

                        <!-- Enable/Disable -->
                        <Border Background="#F8F9FA"
                                Padding="15"
                                CornerRadius="6"
                                Margin="0,0,0,20">
                            <StackPanel>
                                <CheckBox Name="EnableCustomDictionaryCheckBox"
                                          Content="Enable VoiceShortcuts"
                                          IsChecked="True"
                                          FontSize="13"
                                          FontWeight="SemiBold"
                                          Margin="0,0,0,8"/>
                                <TextBlock Name="DictionaryCountText"
                                           Text="0 entries loaded"
                                           FontSize="12"
                                           Foreground="#666666"
                                           Margin="20,0,0,0"/>
                            </StackPanel>
                        </Border>

                        <!-- Quick Actions -->
                        <GroupBox Header="Quick Actions" Margin="0,0,0,20">
                            <StackPanel Margin="10">
                                <Button Name="ManageDictionaryButton"
                                        Content="📝 Manage VoiceShortcuts"
                                        Height="40"
                                        FontSize="13"
                                        HorizontalAlignment="Stretch"
                                        Click="ManageDictionaryButton_Click"
                                        ToolTip="Add, edit, or remove voice shortcuts and custom word replacements"
                                        Margin="0,0,0,10"/>

                                <TextBlock Text="Load Pre-built Templates:"
                                           FontWeight="SemiBold"
                                           FontSize="12"
                                           Margin="0,10,0,8"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <Button Name="LoadMedicalTemplateButton"
                                            Grid.Column="0"
                                            Content="🏥 Medical (33 terms)"
                                            Height="35"
                                            FontSize="11"
                                            Margin="0,0,5,0"
                                            Click="LoadMedicalTemplate_Click"
                                            ToolTip="Load medical abbreviations: BP, CBC, PRN, etc."/>
                                    <Button Name="LoadLegalTemplateButton"
                                            Grid.Column="1"
                                            Content="⚖️ Legal (20 terms)"
                                            Height="35"
                                            FontSize="11"
                                            Margin="5,0,5,0"
                                            Click="LoadLegalTemplate_Click"
                                            ToolTip="Load legal terms: SCOTUS, NDA, LLC, etc."/>
                                    <Button Name="LoadTechTemplateButton"
                                            Grid.Column="2"
                                            Content="💻 Tech (31 terms)"
                                            Height="35"
                                            FontSize="11"
                                            Margin="5,0,0,0"
                                            Click="LoadTechTemplate_Click"
                                            ToolTip="Load tech abbreviations: AWS, k8s, API, etc."/>
                                </Grid>
                            </StackPanel>
                        </GroupBox>

                        <!-- Examples -->
                        <GroupBox Header="Examples" Margin="0,0,0,0">
                            <StackPanel Margin="10">
                                <TextBlock Text="Medical:" FontWeight="SemiBold" FontSize="12" Margin="0,0,0,5"/>
                                <TextBlock Text="• Say 'BP is elevated' → 'blood pressure is elevated'"
                                           FontSize="11" Foreground="#666666" Margin="10,0,0,3"/>
                                <TextBlock Text="• Say 'CBC was normal' → 'complete blood count was normal'"
                                           FontSize="11" Foreground="#666666" Margin="10,0,0,10"/>

                                <TextBlock Text="Tech:" FontWeight="SemiBold" FontSize="12" Margin="0,0,0,5"/>
                                <TextBlock Text="• Say 'Deploy to k8s' → 'Deploy to Kubernetes'"
                                           FontSize="11" Foreground="#666666" Margin="10,0,0,3"/>
                                <TextBlock Text="• Say 'Using AWS' → 'Using Amazon Web Services'"
                                           FontSize="11" Foreground="#666666" Margin="10,0,0,10"/>

                                <TextBlock Text="Custom:" FontWeight="SemiBold" FontSize="12" Margin="0,0,0,5"/>
                                <TextBlock Text="• Pattern: 'VL' → Replacement: 'VoiceLite'"
                                           FontSize="11" Foreground="#666666" Margin="10,0,0,0"/>
                            </StackPanel>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Advanced Tab -->
            <TabItem Header="Advanced">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                    <StackPanel>
                        <!-- Whisper Advanced Parameters -->
                        <GroupBox Header="Whisper Parameters" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="150"/>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <TextBlock Grid.Row="0" Grid.Column="0"
                                               Text="Beam size:"
                                               VerticalAlignment="Center"
                                               Margin="0,0,0,10"/>
                                    <TextBox Grid.Row="0" Grid.Column="1"
                                             Name="BeamSizeTextBox"
                                             Width="60"
                                             HorizontalAlignment="Left"
                                             Margin="0,0,0,10"/>
                                    <TextBlock Grid.Row="0" Grid.Column="2"
                                               Text="(Higher = more accurate but slower)"
                                               FontSize="11"
                                               Foreground="Gray"
                                               VerticalAlignment="Center"
                                               Margin="10,0,0,10"/>

                                    <TextBlock Grid.Row="1" Grid.Column="0"
                                               Text="Best of:"
                                               VerticalAlignment="Center"
                                               Margin="0,0,0,10"/>
                                    <TextBox Grid.Row="1" Grid.Column="1"
                                             Name="BestOfTextBox"
                                             Width="60"
                                             HorizontalAlignment="Left"
                                             Margin="0,0,0,10"/>
                                    <TextBlock Grid.Row="1" Grid.Column="2"
                                               Text="(Number of candidates to consider)"
                                               FontSize="11"
                                               Foreground="Gray"
                                               VerticalAlignment="Center"
                                               Margin="10,0,0,10"/>

                                    <TextBlock Grid.Row="2" Grid.Column="0"
                                               Text="Timeout multiplier:"
                                               VerticalAlignment="Center"/>
                                    <TextBox Grid.Row="2" Grid.Column="1"
                                             Name="TimeoutMultiplierTextBox"
                                             Width="60"
                                             HorizontalAlignment="Left"/>
                                    <TextBlock Grid.Row="2" Grid.Column="2"
                                               Text="(Seconds per audio second)"
                                               FontSize="11"
                                               Foreground="Gray"
                                               VerticalAlignment="Center"
                                               Margin="10,0,0,0"/>
                                </Grid>
                            </StackPanel>
                        </GroupBox>

                        <!-- Audio Preprocessing -->
                        <GroupBox Header="Audio Preprocessing" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                <CheckBox Name="NoiseSuppressionCheckBox"
                                          Content="Enable noise suppression"
                                          Margin="0,0,0,5"/>
                                <CheckBox Name="AutoGainCheckBox"
                                          Content="Enable automatic gain control"
                                          Margin="0,0,0,10"/>

                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="150"/>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <TextBlock Grid.Row="0" Grid.Column="0"
                                               Text="Target RMS level:"
                                               VerticalAlignment="Center"
                                               Margin="0,0,0,10"/>
                                    <TextBox Grid.Row="0" Grid.Column="1"
                                             Name="TargetRmsTextBox"
                                             Width="60"
                                             HorizontalAlignment="Left"
                                             Margin="0,0,0,10"/>

                                    <TextBlock Grid.Row="1" Grid.Column="0"
                                               Text="Noise gate threshold:"
                                               VerticalAlignment="Center"/>
                                    <TextBox Grid.Row="1" Grid.Column="1"
                                             Name="NoiseThresholdTextBox"
                                             Width="60"
                                             HorizontalAlignment="Left"/>
                                </Grid>
                            </StackPanel>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Privacy Tab -->
            <TabItem Header="Privacy">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                    <StackPanel>
                        <!-- Offline Processing -->
                        <Border Style="{StaticResource SuccessBoxStyle}" Margin="0,0,0,16">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                    <TextBlock Text="🔒" FontSize="18" Margin="0,0,8,0"/>
                                    <TextBlock Text="100% Offline Processing" FontWeight="Bold" FontSize="14" Foreground="#2E7D32"/>
                                </StackPanel>
                                <TextBlock TextWrapping="Wrap" FontSize="12" Foreground="#2E7D32">
                                    All voice recordings are processed locally using OpenAI Whisper AI running on your PC. Your voice data never leaves your computer. No internet connection required (except for optional Pro tier license validation).
                                </TextBlock>
                            </StackPanel>
                        </Border>

                        <!-- Data Storage Locations -->
                        <Border Style="{StaticResource SettingsCardStyle}">
                            <StackPanel>
                                <!-- Section Header -->
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,14">
                                    <TextBlock Text="💾" Style="{StaticResource SettingsIconStyle}"/>
                                    <StackPanel>
                                        <TextBlock Text="Data Storage Locations" Style="{StaticResource SettingsSectionHeaderStyle}"/>
                                        <TextBlock Text="Where VoiceLite stores your data on your PC" Style="{StaticResource SettingsSectionDescStyle}"/>
                                    </StackPanel>
                                </StackPanel>

                                <!-- Settings File -->
                                <TextBlock Text="Settings &amp; Preferences" FontWeight="SemiBold" FontSize="13" Margin="0,0,0,4"/>
                                <TextBlock Text="%LOCALAPPDATA%\VoiceLite\settings.json"
                                           FontFamily="Consolas"
                                           FontSize="11"
                                           Foreground="#666666"
                                           Margin="0,0,0,4"/>
                                <TextBlock Text="Stores your hotkey, model selection, and all app settings"
                                           Style="{StaticResource SettingsHelperTextStyle}"
                                           Margin="0,0,0,12"/>

                                <!-- Transcription History -->
                                <TextBlock Text="Transcription History" FontWeight="SemiBold" FontSize="13" Margin="0,0,0,4"/>
                                <TextBlock Text="Saved in settings.json (max 50 items)"
                                           FontFamily="Consolas"
                                           FontSize="11"
                                           Foreground="#666666"
                                           Margin="0,0,0,4"/>
                                <TextBlock Text="Recent transcriptions displayed in the history panel. Does NOT sync across PCs."
                                           Style="{StaticResource SettingsHelperTextStyle}"
                                           Margin="0,0,0,12"/>

                                <!-- Error Logs -->
                                <TextBlock Text="Error Logs" FontWeight="SemiBold" FontSize="13" Margin="0,0,0,4"/>
                                <TextBlock Text="%LOCALAPPDATA%\VoiceLite\logs\voicelite.log"
                                           FontFamily="Consolas"
                                           FontSize="11"
                                           Foreground="#666666"
                                           Margin="0,0,0,4"/>
                                <TextBlock Text="Debug information for troubleshooting. Does NOT contain transcription text."
                                           Style="{StaticResource SettingsHelperTextStyle}"
                                           Margin="0,0,0,12"/>

                                <!-- Whisper Models -->
                                <TextBlock Text="AI Models" FontWeight="SemiBold" FontSize="13" Margin="0,0,0,4"/>
                                <TextBlock Text="[Installation Directory]\whisper\"
                                           FontFamily="Consolas"
                                           FontSize="11"
                                           Foreground="#666666"
                                           Margin="0,0,0,4"/>
                                <TextBlock Text="OpenAI Whisper models (Pro: 466MB, Elite: 1.5GB, Ultra: 2.9GB)"
                                           Style="{StaticResource SettingsHelperTextStyle}"/>

                                <!-- Note -->
                                <Border Style="{StaticResource InfoBoxStyle}">
                                    <TextBlock TextWrapping="Wrap" FontSize="11" Foreground="#1976D2">
                                        <Run Text="ℹ️ Privacy Note:" FontWeight="Bold"/>
                                        <Run Text="Changed from Roaming to Local AppData (v1.0.19) to prevent transcription history from syncing across PCs via Microsoft account."/>
                                    </TextBlock>
                                </Border>
                            </StackPanel>
                        </Border>

                        <!-- Analytics Settings -->
                        <Border Style="{StaticResource SettingsCardStyle}">
                            <StackPanel>
                                <!-- Section Header -->
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,14">
                                    <TextBlock Text="📊" Style="{StaticResource SettingsIconStyle}"/>
                                    <StackPanel>
                                        <TextBlock Text="Anonymous Analytics" Style="{StaticResource SettingsSectionHeaderStyle}"/>
                                        <TextBlock Text="Help us improve VoiceLite (completely optional)" Style="{StaticResource SettingsSectionDescStyle}"/>
                                    </StackPanel>
                                </StackPanel>

                                <!-- Enable/Disable -->
                                <CheckBox Name="EnableAnalyticsCheckBox"
                                          Margin="0,0,0,12"
                                          Checked="EnableAnalyticsCheckBox_Changed"
                                          Unchecked="EnableAnalyticsCheckBox_Changed">
                                    <StackPanel>
                                        <TextBlock Text="Send anonymous usage analytics" FontWeight="SemiBold" FontSize="13"/>
                                        <TextBlock Text="Help us improve VoiceLite by sending anonymous usage data"
                                                   Style="{StaticResource SettingsHelperTextStyle}"
                                                   Margin="0,3,0,0"/>
                                    </StackPanel>
                                </CheckBox>

                                <!-- What We Track -->
                                <TextBlock Text="What we track:" FontWeight="SemiBold" FontSize="12" Margin="0,8,0,6"/>
                                <TextBlock Text="• App version and operating system" FontSize="11" Foreground="#666666" Margin="15,0,0,3"/>
                                <TextBlock Text="• Model used (Lite, Pro, Elite, Ultra)" FontSize="11" Foreground="#666666" Margin="15,0,0,3"/>
                                <TextBlock Text="• Daily transcription count (aggregated, no content)" FontSize="11" Foreground="#666666" Margin="15,0,0,3"/>
                                <TextBlock Text="• Anonymous user ID (SHA256 hash, irreversible)" FontSize="11" Foreground="#666666" Margin="15,0,0,12"/>

                                <!-- What We DON'T Track -->
                                <TextBlock Text="What we DON'T track:" FontWeight="SemiBold" FontSize="12" Margin="0,0,0,6"/>
                                <TextBlock Text="• Voice recordings or audio data" FontSize="11" Foreground="#666666" Margin="15,0,0,3"/>
                                <TextBlock Text="• Transcription text or content" FontSize="11" Foreground="#666666" Margin="15,0,0,3"/>
                                <TextBlock Text="• Personal information (name, email)" FontSize="11" Foreground="#666666" Margin="15,0,0,3"/>
                                <TextBlock Text="• Keystrokes or screen content" FontSize="11" Foreground="#666666" Margin="15,0,0,3"/>
                                <TextBlock Text="• IP addresses (not logged by backend)" FontSize="11" Foreground="#666666" Margin="15,0,0,0"/>
                            </StackPanel>
                        </Border>

                        <!-- Permissions & Security -->
                        <Border Style="{StaticResource SettingsCardStyle}">
                            <StackPanel>
                                <!-- Section Header -->
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,14">
                                    <TextBlock Text="🛡️" Style="{StaticResource SettingsIconStyle}"/>
                                    <StackPanel>
                                        <TextBlock Text="Permissions &amp; Security" Style="{StaticResource SettingsSectionHeaderStyle}"/>
                                        <TextBlock Text="Windows permissions required for core features" Style="{StaticResource SettingsSectionDescStyle}"/>
                                    </StackPanel>
                                </StackPanel>

                                <!-- Permissions List -->
                                <TextBlock Text="Microphone Access" FontWeight="SemiBold" FontSize="13" Margin="0,0,0,4"/>
                                <TextBlock Text="Required to record your voice for transcription"
                                           Style="{StaticResource SettingsHelperTextStyle}"
                                           Margin="0,0,0,10"/>

                                <TextBlock Text="Clipboard Access" FontWeight="SemiBold" FontSize="13" Margin="0,0,0,4"/>
                                <TextBlock Text="Required to copy/paste transcribed text into applications"
                                           Style="{StaticResource SettingsHelperTextStyle}"
                                           Margin="0,0,0,10"/>

                                <TextBlock Text="Global Keyboard Hooks" FontWeight="SemiBold" FontSize="13" Margin="0,0,0,4"/>
                                <TextBlock Text="Required to detect your recording hotkey anywhere in Windows"
                                           Style="{StaticResource SettingsHelperTextStyle}"
                                           Margin="0,0,0,10"/>

                                <TextBlock Text="Input Simulation" FontWeight="SemiBold" FontSize="13" Margin="0,0,0,4"/>
                                <TextBlock Text="Required to auto-paste text into active application (when enabled)"
                                           Style="{StaticResource SettingsHelperTextStyle}"/>

                                <!-- Security Note -->
                                <Border Style="{StaticResource WarningBoxStyle}">
                                    <TextBlock TextWrapping="Wrap" FontSize="11" Foreground="#E65100">
                                        <Run Text="⚠️ Antivirus Warning:" FontWeight="Bold"/>
                                        <Run Text="Global hotkeys and input simulation may trigger false positives in antivirus software. VoiceLite is open source and safe."/>
                                    </TextBlock>
                                </Border>
                            </StackPanel>
                        </Border>

                        <!-- Clear Data -->
                        <Border Style="{StaticResource SettingsCardStyle}">
                            <StackPanel>
                                <!-- Section Header -->
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,14">
                                    <TextBlock Text="🗑️" Style="{StaticResource SettingsIconStyle}"/>
                                    <StackPanel>
                                        <TextBlock Text="Clear Data" Style="{StaticResource SettingsSectionHeaderStyle}"/>
                                        <TextBlock Text="Delete local data and reset settings" Style="{StaticResource SettingsSectionDescStyle}"/>
                                    </StackPanel>
                                </StackPanel>

                                <!-- Clear History -->
                                <Button Name="ClearHistoryButton"
                                        Content="🗑️ Clear Transcription History"
                                        Width="220"
                                        HorizontalAlignment="Left"
                                        Margin="0,0,0,10"
                                        ToolTip="Delete all transcription history items (including pinned)"
                                        Click="ClearHistoryButton_Click"/>

                                <!-- Clear Logs -->
                                <Button Name="ClearLogsButton"
                                        Content="🗑️ Clear Error Logs"
                                        Width="220"
                                        HorizontalAlignment="Left"
                                        Margin="0,0,0,10"
                                        ToolTip="Delete voicelite.log file (error logs)"
                                        Click="ClearLogsButton_Click"/>

                                <!-- Reset Settings -->
                                <Button Name="ResetSettingsButton"
                                        Content="⚙️ Reset to Defaults"
                                        Width="220"
                                        HorizontalAlignment="Left"
                                        ToolTip="Reset all settings to default values"
                                        Click="ResetSettingsButton_Click"/>

                                <!-- Warning -->
                                <Border Style="{StaticResource WarningBoxStyle}">
                                    <TextBlock TextWrapping="Wrap" FontSize="11" Foreground="#E65100">
                                        <Run Text="⚠️ Warning:" FontWeight="Bold"/>
                                        <Run Text="These actions cannot be undone. Your data will be permanently deleted."/>
                                    </TextBlock>
                                </Border>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
        </TabControl>

        <!-- Footer with Buttons -->
        <Border Grid.Row="2"
                Background="#F5F5F5"
                BorderBrush="#E0E0E0"
                BorderThickness="0,1,0,0">
            <Grid Margin="20,10">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Status Text and Keyboard Shortcuts Hint -->
                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Name="StatusText"
                               Text=""
                               FontSize="12"
                               Foreground="#606060"
                               VerticalAlignment="Center"
                               Margin="0,0,15,0"/>
                    <TextBlock Text="💡 Tip: Ctrl+S to save, Esc to cancel"
                               FontSize="11"
                               Foreground="#95A5A6"
                               VerticalAlignment="Center"/>
                </StackPanel>

                <!-- Action Buttons -->
                <StackPanel Grid.Column="1"
                            Orientation="Horizontal"
                            HorizontalAlignment="Right">
                    <Button Name="ApplyButton"
                            Content="Apply"
                            Width="80"
                            Margin="0,0,10,0"
                            Click="ApplyButton_Click"/>
                    <Button Name="SaveButton"
                            Content="Save"
                            Width="80"
                            Margin="0,0,10,0"
                            Click="SaveButton_Click"
                            IsDefault="True"/>
                    <Button Name="CancelButton"
                            Content="Cancel"
                            Width="80"
                            Click="CancelButton_Click"
                            IsCancel="True"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>
