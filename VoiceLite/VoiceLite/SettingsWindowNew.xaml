<Window x:Class="VoiceLite.SettingsWindowNew"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:controls="clr-namespace:VoiceLite.Controls"
        mc:Ignorable="d"
        Title="VoiceLite Settings" Height="650" Width="850"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResize"
        MinHeight="500" MinWidth="700">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="#FAFAFA" Padding="20,15">
            <TextBlock Text="VoiceLite Settings" FontSize="20" FontWeight="SemiBold" Foreground="#333333"/>
        </Border>

        <!-- Tabbed Content -->
        <TabControl Grid.Row="1"
                    Name="SettingsTabControl"
                    TabStripPlacement="Top"
                    Margin="0"
                    BorderThickness="0"
                    Background="White">
            <TabControl.Resources>
                <Style TargetType="TabItem">
                    <Setter Property="Padding" Value="15,8"/>
                    <Setter Property="FontSize" Value="13"/>
                    <Setter Property="Cursor" Value="Hand"/>
                </Style>
            </TabControl.Resources>

            <!-- General Settings Tab -->
            <TabItem Header="General">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                    <StackPanel>
                        <!-- Hotkey Settings -->
                        <GroupBox Header="Hotkey Settings" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                <TextBlock Text="Record Hotkey:" Margin="0,0,0,5"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" MaxWidth="300"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>

                                    <TextBox Name="HotkeyTextBox"
                                             Grid.Column="0"
                                             IsReadOnly="True"
                                             Text="F1"
                                             Padding="5"
                                             Background="#F0F0F0"
                                             PreviewKeyDown="HotkeyTextBox_PreviewKeyDown"
                                             GotFocus="HotkeyTextBox_GotFocus"
                                             LostFocus="HotkeyTextBox_LostFocus"/>

                                    <Button Name="ClearHotkeyButton"
                                            Grid.Column="1"
                                            Content="Clear"
                                            Width="60"
                                            Margin="5,0,0,0"
                                            Click="ClearHotkeyButton_Click"/>
                                </Grid>
                                <TextBlock Name="HotkeyInstructionText"
                                           Text="Click the box and press your desired key combination"
                                           FontSize="11"
                                           Foreground="Gray"
                                           Margin="0,5,0,0"
                                           Visibility="Visible"/>
                            </StackPanel>
                        </GroupBox>

                        <!-- Recording Mode -->
                        <GroupBox Header="Recording Mode" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                <RadioButton Name="PushToTalkRadio"
                                             Content="Push-to-Talk (Hold key to record)"
                                             IsChecked="True"
                                             Margin="0,0,0,5"/>
                                <RadioButton Name="ToggleRadio"
                                             Content="Toggle (Press once to start, again to stop)"
                                             IsEnabled="True"/>
                            </StackPanel>
                        </GroupBox>

                        <!-- Audio Settings -->
                        <GroupBox Header="Audio Settings" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                <TextBlock Text="Microphone:" Margin="0,0,0,5"/>
                                <ComboBox Name="MicrophoneComboBox"
                                          Margin="0,0,0,10"
                                          DisplayMemberPath="Name"
                                          MaxWidth="400"
                                          HorizontalAlignment="Left"/>
                                <Button Name="RefreshMicrophonesButton"
                                        Content="Refresh Microphones"
                                        Width="150"
                                        HorizontalAlignment="Left"
                                        Click="RefreshMicrophonesButton_Click"/>

                                <CheckBox Name="PlaySoundFeedbackCheckBox"
                                          Content="Play sound feedback (beep on record start/stop)"
                                          Margin="0,10,0,5"/>

                                <CheckBox Name="AutoPasteCheckBox"
                                          Content="Auto-paste transcribed text (Ctrl+V)"
                                          IsChecked="True"
                                          Margin="0,0,0,0"
                                          ToolTip="When enabled, transcribed text will automatically paste into the active application. When disabled, text is only copied to clipboard."/>
                            </StackPanel>
                        </GroupBox>

                        <!-- Other Settings -->
                        <GroupBox Header="System Settings" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                <CheckBox Name="StartWithWindowsCheckBox"
                                          Content="Start with Windows"
                                          Margin="0,0,0,5"
                                          IsEnabled="False"/>
                                <CheckBox Name="MinimizeToTrayCheckBox"
                                          Content="Minimize to system tray on close"
                                          IsChecked="True"
                                          Margin="0,0,0,5"/>
                                <CheckBox Name="ShowTrayIconCheckBox"
                                          Content="Show system tray icon"
                                          IsChecked="True"
                                          IsEnabled="False"
                                          Margin="0,0,0,5"/>
                            </StackPanel>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Whisper Model Tab -->
            <TabItem Header="AI Model" Name="ModelTab">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                    <StackPanel>
                        <controls:SimpleModelSelector x:Name="SimpleModelSelector"
                                                      ModelSelected="SimpleModelSelector_ModelSelected"/>

                        <Button Name="DownloadModelsButton"
                                Content="Download Medium Model (1.5GB)"
                                Height="35"
                                Margin="0,15,0,0"
                                Click="DownloadModelsButton_Click"
                                Visibility="Visible"/>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Dictionary Tab -->
            <TabItem Header="Dictionary" Name="DictionaryTab">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                    <StackPanel>
                        <!-- Header Info -->
                        <TextBlock Text="Custom Dictionary"
                                   FontSize="18"
                                   FontWeight="SemiBold"
                                   Foreground="#333333"
                                   Margin="0,0,0,8"/>
                        <TextBlock Text="Create custom word replacements to improve transcription accuracy. Perfect for abbreviations, industry terms, and personal names."
                                   TextWrapping="Wrap"
                                   Foreground="#666666"
                                   FontSize="12"
                                   Margin="0,0,0,20"/>

                        <!-- Enable/Disable -->
                        <Border Background="#F8F9FA"
                                Padding="15"
                                CornerRadius="6"
                                Margin="0,0,0,20">
                            <StackPanel>
                                <CheckBox Name="EnableCustomDictionaryCheckBox"
                                          Content="Enable custom dictionary replacements"
                                          IsChecked="True"
                                          FontSize="13"
                                          FontWeight="SemiBold"
                                          Margin="0,0,0,8"/>
                                <TextBlock Name="DictionaryCountText"
                                           Text="0 entries loaded"
                                           FontSize="12"
                                           Foreground="#666666"
                                           Margin="20,0,0,0"/>
                            </StackPanel>
                        </Border>

                        <!-- Quick Actions -->
                        <GroupBox Header="Quick Actions" Margin="0,0,0,20">
                            <StackPanel Margin="10">
                                <Button Name="ManageDictionaryButton"
                                        Content="📝 Manage Dictionary Entries"
                                        Height="40"
                                        FontSize="13"
                                        HorizontalAlignment="Stretch"
                                        Click="ManageDictionaryButton_Click"
                                        ToolTip="Add, edit, or remove custom word replacements"
                                        Margin="0,0,0,10"/>

                                <TextBlock Text="Load Pre-built Templates:"
                                           FontWeight="SemiBold"
                                           FontSize="12"
                                           Margin="0,10,0,8"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <Button Name="LoadMedicalTemplateButton"
                                            Grid.Column="0"
                                            Content="🏥 Medical (33 terms)"
                                            Height="35"
                                            FontSize="11"
                                            Margin="0,0,5,0"
                                            Click="LoadMedicalTemplate_Click"
                                            ToolTip="Load medical abbreviations: BP, CBC, PRN, etc."/>
                                    <Button Name="LoadLegalTemplateButton"
                                            Grid.Column="1"
                                            Content="⚖️ Legal (20 terms)"
                                            Height="35"
                                            FontSize="11"
                                            Margin="5,0,5,0"
                                            Click="LoadLegalTemplate_Click"
                                            ToolTip="Load legal terms: SCOTUS, NDA, LLC, etc."/>
                                    <Button Name="LoadTechTemplateButton"
                                            Grid.Column="2"
                                            Content="💻 Tech (31 terms)"
                                            Height="35"
                                            FontSize="11"
                                            Margin="5,0,0,0"
                                            Click="LoadTechTemplate_Click"
                                            ToolTip="Load tech abbreviations: AWS, k8s, API, etc."/>
                                </Grid>
                            </StackPanel>
                        </GroupBox>

                        <!-- Examples -->
                        <GroupBox Header="Examples" Margin="0,0,0,0">
                            <StackPanel Margin="10">
                                <TextBlock Text="Medical:" FontWeight="SemiBold" FontSize="12" Margin="0,0,0,5"/>
                                <TextBlock Text="• Say 'BP is elevated' → 'blood pressure is elevated'"
                                           FontSize="11" Foreground="#666666" Margin="10,0,0,3"/>
                                <TextBlock Text="• Say 'CBC was normal' → 'complete blood count was normal'"
                                           FontSize="11" Foreground="#666666" Margin="10,0,0,10"/>

                                <TextBlock Text="Tech:" FontWeight="SemiBold" FontSize="12" Margin="0,0,0,5"/>
                                <TextBlock Text="• Say 'Deploy to k8s' → 'Deploy to Kubernetes'"
                                           FontSize="11" Foreground="#666666" Margin="10,0,0,3"/>
                                <TextBlock Text="• Say 'Using AWS' → 'Using Amazon Web Services'"
                                           FontSize="11" Foreground="#666666" Margin="10,0,0,10"/>

                                <TextBlock Text="Custom:" FontWeight="SemiBold" FontSize="12" Margin="0,0,0,5"/>
                                <TextBlock Text="• Pattern: 'VL' → Replacement: 'VoiceLite'"
                                           FontSize="11" Foreground="#666666" Margin="10,0,0,0"/>
                            </StackPanel>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Advanced Tab -->
            <TabItem Header="Advanced">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                    <StackPanel>
                        <!-- Whisper Advanced Parameters -->
                        <GroupBox Header="Whisper Parameters" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="150"/>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <TextBlock Grid.Row="0" Grid.Column="0"
                                               Text="Beam size:"
                                               VerticalAlignment="Center"
                                               Margin="0,0,0,10"/>
                                    <TextBox Grid.Row="0" Grid.Column="1"
                                             Name="BeamSizeTextBox"
                                             Width="60"
                                             HorizontalAlignment="Left"
                                             Margin="0,0,0,10"/>
                                    <TextBlock Grid.Row="0" Grid.Column="2"
                                               Text="(Higher = more accurate but slower)"
                                               FontSize="11"
                                               Foreground="Gray"
                                               VerticalAlignment="Center"
                                               Margin="10,0,0,10"/>

                                    <TextBlock Grid.Row="1" Grid.Column="0"
                                               Text="Best of:"
                                               VerticalAlignment="Center"
                                               Margin="0,0,0,10"/>
                                    <TextBox Grid.Row="1" Grid.Column="1"
                                             Name="BestOfTextBox"
                                             Width="60"
                                             HorizontalAlignment="Left"
                                             Margin="0,0,0,10"/>
                                    <TextBlock Grid.Row="1" Grid.Column="2"
                                               Text="(Number of candidates to consider)"
                                               FontSize="11"
                                               Foreground="Gray"
                                               VerticalAlignment="Center"
                                               Margin="10,0,0,10"/>

                                    <TextBlock Grid.Row="2" Grid.Column="0"
                                               Text="Timeout multiplier:"
                                               VerticalAlignment="Center"/>
                                    <TextBox Grid.Row="2" Grid.Column="1"
                                             Name="TimeoutMultiplierTextBox"
                                             Width="60"
                                             HorizontalAlignment="Left"/>
                                    <TextBlock Grid.Row="2" Grid.Column="2"
                                               Text="(Seconds per audio second)"
                                               FontSize="11"
                                               Foreground="Gray"
                                               VerticalAlignment="Center"
                                               Margin="10,0,0,0"/>
                                </Grid>
                            </StackPanel>
                        </GroupBox>

                        <!-- Audio Preprocessing -->
                        <GroupBox Header="Audio Preprocessing" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                <CheckBox Name="NoiseSuppressionCheckBox"
                                          Content="Enable noise suppression"
                                          Margin="0,0,0,5"/>
                                <CheckBox Name="AutoGainCheckBox"
                                          Content="Enable automatic gain control"
                                          Margin="0,0,0,10"/>

                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="150"/>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <TextBlock Grid.Row="0" Grid.Column="0"
                                               Text="Target RMS level:"
                                               VerticalAlignment="Center"
                                               Margin="0,0,0,10"/>
                                    <TextBox Grid.Row="0" Grid.Column="1"
                                             Name="TargetRmsTextBox"
                                             Width="60"
                                             HorizontalAlignment="Left"
                                             Margin="0,0,0,10"/>

                                    <TextBlock Grid.Row="1" Grid.Column="0"
                                               Text="Noise gate threshold:"
                                               VerticalAlignment="Center"/>
                                    <TextBox Grid.Row="1" Grid.Column="1"
                                             Name="NoiseThresholdTextBox"
                                             Width="60"
                                             HorizontalAlignment="Left"/>
                                </Grid>
                            </StackPanel>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
        </TabControl>

        <!-- Footer with Buttons -->
        <Border Grid.Row="2"
                Background="#F5F5F5"
                BorderBrush="#E0E0E0"
                BorderThickness="0,1,0,0">
            <Grid Margin="20,10">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Status Text -->
                <TextBlock Grid.Column="0"
                           Name="StatusText"
                           Text=""
                           FontSize="12"
                           Foreground="#606060"
                           VerticalAlignment="Center"/>

                <!-- Action Buttons -->
                <StackPanel Grid.Column="1"
                            Orientation="Horizontal"
                            HorizontalAlignment="Right">
                    <Button Name="ApplyButton"
                            Content="Apply"
                            Width="80"
                            Margin="0,0,10,0"
                            Click="ApplyButton_Click"/>
                    <Button Name="SaveButton"
                            Content="Save"
                            Width="80"
                            Margin="0,0,10,0"
                            Click="SaveButton_Click"
                            IsDefault="True"/>
                    <Button Name="CancelButton"
                            Content="Cancel"
                            Width="80"
                            Click="CancelButton_Click"
                            IsCancel="True"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>
